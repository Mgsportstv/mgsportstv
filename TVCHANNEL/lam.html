
<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Watch {{View}} - MaFiA</title>
<link rel="icon" href="https://i.ibb.co/ScZnmpJ/fire-Sports-s.png" />
<link rel="shortcut icon" href="https://i.ibb.co/ScZnmpJ/fire-Sports-s.png" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" />
<script src="https://content.jwplatform.com/libraries/IDzF9Zmk.js"></script>
<style>
body { background-color: #000000; color: #FFFFFF; font-family: "Montserrat", sans-serif; }
.btn { border-radius: 26px; font-weight: bold; padding-left: 22px; padding-right: 22px; }
.topHeader { margin-top: 20px; margin-left: 10px; }
.mainContent { margin-top: 25px; margin-left: 10px; }
.card { color: #FFFFFF; border-radius:2rem .3rem; background-color: #202020 !important; text-align: center; justify-content: center; item-align: center; border:2px solid black; }
.card:hover { background-color: rgba(165, 42, 42, 0.521); border-color:white; border:2px solid white; }
.card:hover .card-text { color:white; }
.card a { text-decoration: none; color: #FFFFFF; }
.tvimage { background-color: #FFFFFF; padding: 4px; border-radius: 22px; }
.gridErrorMsg { color: #ee3c3c; font-weight: bold; }
#serverModalLabel { color: #000000; }
.uuu_buttons-container { position: fixed; top: 20px; right: 20px; z-index: 1050; display: flex; flex-direction: column; gap: 10px; }
.uuu_server-btn { font-size: 24px; }
@media (max-width: 768px) { .uuu_buttons-container { top: 15px; right: 15px; } }
</style>
<style>
       
        

        /* Popup styles */
        .popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #1c1c1c;
            border-radius: 20px; /* Rounded card style */
            padding: 20px;
            text-align: center;
            box-shadow: 0px 0px 15px rgba(255, 255, 255, 0.2);
            z-index: 1002;
            width: 90%;
            max-width: 400px;
            animation: fadeIn 0.5s;
        }

        .popup h2 {
            color: #ffcc00;
            margin-bottom: 10px;
            font-size: 20px;
        }

        .popup p {
            margin-bottom: 20px;
            color: #ccc;
            font-size: 16px;
        }

        .popup button {
            background-color: #0088cc;
            color: #fff;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-bottom: 10px;
            width: 100%;
        }

        .popup button:hover {
            background-color: #006699;
        }

        .popup .close-btn {
            background-color: #555;
        }

        .popup .close-btn:hover {
            background-color: #333;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
    </style>
</head>
<body>

<div class="uuu_buttons-container"></div>
<div align="center" class="playerContainer"><div id="vplayer"></div></div>

<div class="modal fade" id="serverModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="serverModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="serverModalLabel"></h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="serverModalBody"></div>
      </div>
    </div>
  </div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script>
let SERVICE__REST_API = "service.php";
$(document).ready(function(){
    let view = getQueryParam("view");
    switch(view) {
    case "schedule":
        screen__schedule();
        break;
    case "channels":
        screen__channels();
        break;
    case "player":
        screen__player();
        break;
    case "schedule_detail":
        screen__schedule_detail();
        break;
    default:
        screen__home();
        break;
    }
});

function screen__home()
{
    document.title = document.title.replace("{{View}}", "Home");
    window.location = "?view=channels";
}

function screen__channels()
{
    document.title = document.title.replace("{{View}}", "Live Channels");
    $("#cbtn_channels").attr("class", "btn btn-warning btn-sm");
    $.ajax({
        "url": SERVICE__REST_API,
        "type": "GET",
        "data": "action=getChannels",
        "success": function(data) {
            try { data = JSON.parse(data); }catch(err){}
            if(data.status == "success")
            {
                let lmtl = '';
                lmtl += '<div class="row mt-3">';
                $.each(data.data.list, function(k, v) {
                    lmtl += '<div class="col-lg-2 col-md-3 col-sm-6 col-6 mb-4" data-tvid="' + v.id + '" data-tvname="' + v.title + '" onclick="playlivetv(this)" title="Watch ' + v.title + ' Live" id="livetvCard">';
                    lmtl += '<div class="card">';
                    lmtl += '<a href="?view=player&id=' + v.id + '&sch=">';
                    lmtl += '<div class="card-body">';
                    lmtl += '<img class="card-img-top tvimage" src="' + v.logo + '" width="160" alt=""/>';
                    lmtl += '<div class="mt-2 prvselect">';
                    lmtl += '<b>' + v.title + '</b>';
                    lmtl += '</div>';
                    lmtl += '</div>';
                    lmtl += '</a>';
                    lmtl += '</div>';
                    lmtl += '</div>';
                });
                lmtl += '</div>';
                $(".mainContent").html(lmtl);
            }
            else
            {
                if(data.status == "error")
                {
                    $(".mainContent").html('<span class="gridErrorMsg">' + data.message + '</span>');
                }
                else
                {
                    $(".mainContent").html('<span class="gridErrorMsg">Unknown Error Occured</span>');
                }
            }
        },
        "error": function(data) {
            $(".mainContent").html('<span class="gridErrorMsg">Server or Network Error Occured</span>');
        }
    });
}

function screen__schedule()
{
    document.title = document.title.replace("{{View}}", "Sports Schedule");
    $("#cbtn_schedule").attr("class", "btn btn-warning btn-sm");
    $.ajax({
        "url": SERVICE__REST_API,
        "type": "GET",
        "data": "action=getSchedule",
        "success": function(data) {
            try { data = JSON.parse(data); }catch(err){}
            if(data.status == "success")
            {
                let lmtl = '';
                lmtl += '<div class="row mt-3">';
                $.each(data.data.list, function(k, v) {
                    if(v.is_live == "true") {
                    lmtl += '<div class="col-lg-2 col-md-3 col-sm-6 col-6 mb-4" title="' + v.title + ' - ' + v.league + ' ' + v.sports + '" id="livetvCard">';
                    lmtl += '<div class="card">';
                    lmtl += '<a href="?view=schedule_detail&id=' + v.id + '">';
                    lmtl += '<div class="card-body">';
                    lmtl += '<img class="tvimage img-thumbnail" src="' + v.logo + '" alt="' + v.title + '"/>';
                    lmtl += '<div class="mt-2 prvselect">';
                    lmtl += '<b>' + v.title + '<br/><span style="color: aqua;">' + v.league + ' ' + v.sports + '</span></b>';
                    lmtl += '</div>';
                    lmtl += '</div>';
                    lmtl += '</a>';
                    lmtl += '</div>';
                    lmtl += '</div>';
                    }
                });
                lmtl += '</div>';
                $(".mainContent").html(lmtl);
            }
            else
            {
                if(data.status == "error")
                {
                    $(".mainContent").html('<span class="gridErrorMsg">' + data.message + '</span>');
                }
                else
                {
                    $(".mainContent").html('<span class="gridErrorMsg">Unknown Error Occured</span>');
                }
            }
        },
        "error": function(data) {
            $(".mainContent").html('<span class="gridErrorMsg">Server or Network Error Occured</span>');
        }
    });
}

function screen__schedule_detail()
{
    document.title = document.title.replace("{{View}}", "Schedule Detail");
    $.ajax({
        "url": SERVICE__REST_API,
        "type": "GET",
        "data": "action=getScheduledetail&id=" + getQueryParam('id'),
        "success": function(data) {
            try { data = JSON.parse(data); }catch(err){}
            if(data.status == "success")
            {
                document.title = document.title.replace("Schedule Detail", data.data.name + ' (' + data.data.league + ' ' + data.data.sports + ')');
                let xpe = '';
                $(".contnTab").html('<h4 style="color: #a1fdbf;"><a href="?view=schedule" style="text-decoration: none; color: yellow;"><i class="fa-solid fa-arrow-left-long"></i></a>&nbsp;&nbsp;' + data.data.name + ' (' + data.data.league + ' ' + data.data.sports + ')</h4>');
                xpe = xpe + `<ul>
                <li><b>Event Name :</b> ` + data.data.name + `</li>
                <li><b>Sports :</b> ` + data.data.sports + `</li>
                <li><b>League :</b> ` + data.data.league + `</li>
                <li><b>Start Time :</b> ` + data.data.start_time + `</li>
                <li><b>End Time :</b> ` + data.data.end_time + `</li>
                </ul>`;
                xpe = xpe + `<div class="table-responsive">
                    <table class="table table-dark">`;
                    $.each(data.data.streams, function(k,v){
                        xpe = xpe + `<tr>
                        <table class="table table-striped table-responsive text-center">
<thead class="table-secondary">
<tr><th>Live Stream</th> <th>Link</th></tr></thead>
<tbody>
<tr><td>`  + v.title + `</td>
<td><a href="?view=player&id=` + v.id + `&sch=` + getQueryParam('id') + `" class="btn btn-success btn-sm"><i class="fa-solid fa-circle-play"></i>&nbsp;Watch</a></td></tr>
	
</tbody>
</table>
                        </tr>`;
                    });
                xpe = xpe + `</table>
                </div>`;
                $(".mainContent").html(xpe);
            }
            else
            {
                if(data.status == "error")
                {
                    $(".mainContent").html('<span class="gridErrorMsg">' + data.message + '</span>');
                }
                else
                {
                    $(".mainContent").html('<span class="gridErrorMsg">Unknown Error Occured</span>');
                }
            }
        },
        "error": function(data) {
            $(".mainContent").html('<span class="gridErrorMsg">Server or Network Error Occured</span>');
        }
    });
}

function screen__player()
{
    sessionStorage.removeItem("b3cO3GsDn");
    sessionStorage.removeItem("cATMzzBiuG");
    document.title = document.title.replace("{{View}}", "Watch TV");
    $.ajax({
        "url": SERVICE__REST_API,
        "type": "GET",
        "data": "action=getStreamdetail&id=" + getQueryParam('id'),
        "success": function(data) {
            try { data = JSON.parse(data); }catch(err){}
            if(data.status == "success")
            {
                $(".uuu_buttons-container").append('<button type="button" title="Change Server" onclick="openPlayerdModal(this)" data-sp="server" class="btn btn-info uuu_server-btn"><i class="fa-solid fa-server"></i></button>');
                let c = 0;
                document.title = document.title.replace("Watch TV", data.data.title);
                sessionStorage.setItem("cATMzzBiuG", JSON.stringify(data.data.servers));
                attach_player("watch.php?id=" + data['data']['servers'][0] + "&e=.m3u8", "");
            }
            else
            {
                if(data.status == "error")
                {
                    if(data.message.includes('Asset Identifier Missing')) {} else { alert("Error: " + data.message); }
                    
                }
                else
                {
                    alert("Error: Something Went Wrong !");
                }
            }
        },
        "error": function(data)
        {
            alert("Error: Server or Networking Failed");
        }
    });
    let scheduleId = getQueryParam('sch');
    if(scheduleId !== undefined && scheduleId !== null && scheduleId !== "")
    {
        $.ajax({
            "url": SERVICE__REST_API,
            "type": "GET",
            "data": "action=getScheduledetail&id=" + getQueryParam('sch'),
            "success": function(data) {
                try { data = JSON.parse(data); }catch(err){}
                if(data.status == "success")
                {
                    sessionStorage.setItem("UmxdgxarXq", JSON.stringify(data.data));
                    $(".uuu_buttons-container").append('<button type="button" title="Change Channel" onclick="openPlayerdModal(this)" data-sp="channels" class="btn btn-danger uuu_server-btn"><i class="fa-solid fa-baseball"></i></button>');
                }
                else
                {
                    if(data.status == "error")
                    {

                    }
                    else
                    {
                        
                    }
                }
            },
            "error": function(data)
            {

            }
        });
    }
}

function openPlayerdModal(t)
{
    let spType = $(t).attr("data-sp");
    if(spType == "server")
    {
        let yxy = "1";
        let prc = sessionStorage.getItem("b3cO3GsDn");
        if(prc !== undefined && prc !== null && prc !== "") { yxy = prc; }
        let scr = ``; let c = 0; let ftu = sessionStorage.getItem("cATMzzBiuG");
        if(ftu !== undefined && ftu !== null && ftu !== "")
        {
            try { ftu = JSON.parse(ftu); }catch(err){ }
            scr += `<ul class="list-group list-group-flush">`;
            $.each(ftu, function(k,v)
            {
                c++;
                scr += `<li class="list-group-item">
                    <a href="javascript:void(0)" onclick="playServer(this)" style="text-decoration: none;" data-n="` + c + `" data-id="` + v + `">
                        <i class="fa-solid fa-circle-play"></i>&nbsp;&nbsp;<b>Server ` + c + `</b>
                    </a>
                    &nbsp;<span class="tid_indi" id="tid_` + v + `_` + c + `"></span>
                </li>`;
            });
            scr += `</ul>`;
            $("#serverModalBody").html(scr);
            let urn = Number(yxy) - Number(1);
            let nvr = "#tid_" + ftu[urn] + "_" + yxy.toString();
            $(".tid_indi").html("");
            window.setTimeout(() => {
                $(nvr).html(`<span class="spinner-grow spinner-grow-sm" aria-hidden="true"></span>`);
            }, 300);
            $("#serverModalLabel").html("Change Server");
            $('#serverModal').modal('show');
        }
    }
    if(spType == "channels")
    {
        let scr = ``;
        let vbv = sessionStorage.getItem("UmxdgxarXq");
        if(vbv !== undefined && vbv !== null && vbv !== "")
        {
            try { vbv = JSON.parse(vbv); }catch(err){}
            scr += `<ul class="list-group list-group-flush">`;
            $.each(vbv.streams, function(k,v)
            {
                scr += `<li class="list-group-item">
                    <a href="?view=player&id=` + v.id + `&sch=` + getQueryParam('sch') + `" style="text-decoration: none;">
                        <i class="fa-solid fa-circle-play"></i>&nbsp;&nbsp;<b>` + v.title + `</b>
                    </a>
                </li>`;
            });
            scr += `</ul>`;
            $("#serverModalLabel").html(vbv.name);
            if(vbv.is_live == "false"){ scr = `<span style="color: red; font-weight: bold;">This Event Has Ended.</span>`; }
            $("#serverModalBody").html(scr);
        }
        else
        {
            $("#serverModalLabel").html("Change Channel");
        }
        
        $('#serverModal').modal('show');
    }
}

function playServer(t)
{
    let idn = $(t).attr("data-id");
    let srn = $(t).attr("data-n");
    $(".tid_indi").html("");
    window.setTimeout(() => {
        let nvr = "#tid_" + idn + "_" + srn;
        $(nvr).html(`<span class="spinner-grow spinner-grow-sm" aria-hidden="true"></span>`);
    }, 250);
    attach_player("watch.php?id=" + idn + "&e=.m3u8", "");
    $("#serverModal").modal("hide");
    sessionStorage.setItem("b3cO3GsDn", srn);
}

function getQueryParam(paramName)
{
  const urlParams = new URLSearchParams(window.location.search);
  return urlParams.get(paramName);
}
function attach_player(playurl, logo)
{
  jwPlyXn = jwplayer("vplayer").setup(
  {
    sources: [
        { file:playurl
    } ],
    autostart: true,
    controls: true,
    aspectratio: "16:9",
    width:"85%",
    image: logo,
    height:"auto",
    stretching:"uniform",
    duration:"",
    preload:"metadata",
    androidhls:"true",
    hlshtml:"false",
    primary:"html5",
    mute:"false",
    sharing: true,
    abouttext: "By MaFiA",
    aboutlink: "https://t.me/freestream247",
    startparam:"start",
    playbackRateControls:[0.25,0.5,0.75,1,1.25,1.5,2],
    logo:
    {
      file: "https://i.postimg.cc/yYmX0ZTr/logo.gif",
      link: "https://t.me/freestream247",
      position: "top-left",
      margin: "5",
      hide: true
    }
  });
  jwPlyXn.play();
}

</script>

<script>
        // Restrict iframe embedding
        if (window.top !== window.self) {
            window.addEventListener('DOMContentLoaded', function() {
                document.body.innerHTML = '<div id="message"></div>';
            });
        }

        // Display a modern pop-up message when the page starts
        window.addEventListener("load", function() {
            // Create the popup element
            var popup = document.createElement("div");
            popup.className = "popup";

            // Set the popup content
            popup.innerHTML = `
              <h2>Support Us!</h2>
              <p>Join our Telegram channel <br>MaFiA official for more updates.</p>
              <button id="joinButton">Join Now</button>
              <button id="closeButton" class="close-btn">Already Joined</button>
            `;

            // Append the popup to the body
            document.body.appendChild(popup);

            // Add click event to the Join Now button
            document.getElementById("joinButton").addEventListener("click", function() {
                window.location.href = "https://t.me/freestream247";
            });

            // Add click event to the Already Joined button to close the popup
            document.getElementById("closeButton").addEventListener("click", function() {
                document.body.removeChild(popup);
            });
        });
    </script>

</body>

<!-- Histats.com  START  (aync)-->
<script type="text/javascript">var _Hasync= _Hasync|| [];
_Hasync.push(['Histats.start', '1,4889696,4,0,0,0,00010000']);
_Hasync.push(['Histats.fasi', '1']);
_Hasync.push(['Histats.track_hits', '']);
(function() {
var hs = document.createElement('script'); hs.type = 'text/javascript'; hs.async = true;
hs.src = ('//s10.histats.com/js15_as.js');
(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(hs);
})();</script>
<noscript><a href="/" target="_blank"><img  src="//sstatic1.histats.com/0.gif?4889696&101" alt="" border="0"></a></noscript>
<!-- Histats.com  END  -->


</html>
